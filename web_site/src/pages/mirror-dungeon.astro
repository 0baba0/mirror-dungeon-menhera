---
// web_site/src/pages/mirror-dungeon.astro
import { getCollection } from 'astro:content';
import SinnerGroup from '../components/SinnerGroup.astro';

const allCharacters = await getCollection('characters');

const sinnerNames = [
  'ì´ìƒ', 'íŒŒìš°ìŠ¤íŠ¸', 'ëˆí‚¤í˜¸í…Œ', 'ë£ŒìŠˆ', 'ë«¼ë¥´ì†Œ', 'í™ë£¨', 
  'íˆìŠ¤í´ë¦¬í”„', 'ì´ìŠ¤ë§ˆì—˜', 'ë¡œìŸˆ', 'ì‹±í´ë ˆì–´', 'ì˜¤í‹°ìŠ¤', 'ê·¸ë ˆê³ ë¥´'
];

const groupedCharacters = sinnerNames.map(name => {
  let identities = allCharacters.filter(c => c.data.characterName === name);
  
  identities.sort((a, b) => {
    if (b.data.grade !== a.data.grade) return b.data.grade - a.data.grade;
    return new Date(b.data.releaseDate).getTime() - new Date(a.data.releaseDate).getTime();
  });

  return { name, identities };
});
---

<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ê±°ìš¸ë˜ì „ | ê±°ìš¸ë˜ì „ ë©˜í—¤ë¼</title>
    <style>
      body {
        margin: 0; font-family: 'Pretendard', sans-serif;
        background-color: #0a0a0a; color: #f5f5f5;
        display: flex; flex-direction: column; min-height: 100vh;
      }
      
      .logo-wrapper {
        display: flex; align-items: center; gap: 0.8rem;
        text-decoration: none;
      }
      .logo-img {
        height: 40px; /* ë¡œê³  í¬ê¸°ëŠ” ì—¬ê¸°ì„œ ì¡°ì ˆí•˜ì„¸ìš” */
        width: auto;
        border-radius: 50%; /* ë¡œê³ ë¥¼ ë™ê·¸ë—ê²Œ ê¹ì•„ì¤ë‹ˆë‹¤ */
        box-shadow: 0 0 10px rgba(234, 179, 8, 0.5);
      }
      .logo-text {
        color: #eab308; font-size: 1.5rem; font-weight: 900;
        letter-spacing: 1px;
      }

      .top-nav {
        background: #111; border-bottom: 1px solid #333;
        padding: 1rem 2rem; display: flex; align-items: center;
      }
      .logo {
        color: #eab308; font-size: 1.5rem; font-weight: 900;
        text-decoration: none; letter-spacing: 1px;
      }

      /* ğŸš€ í•œ ì¤„ì— 6ê°œê°€ ì˜ˆì˜ê²Œ ë“¤ì–´ê°€ë„ë¡ ê°€ë¡œ ë„“ì´ë¥¼ 1800pxë¡œ ëŒ€í­ ëŠ˜ë ¸ìŠµë‹ˆë‹¤ */
      .container { 
        max-width: 1800px; 
        margin: 0 auto; padding: 3rem 1.5rem; flex: 1; width: 100%; box-sizing: border-box;
      }
      .page-title { text-align: center; color: #fff; font-size: 2rem; margin-bottom: 0.5rem; }
      .page-subtitle { text-align: center; color: #888; margin-bottom: 3rem; }
      
      /* ğŸš€ í•µì‹¬: ë¬´ì¡°ê±´ 6ì¹¸(1fr)ìœ¼ë¡œ ìª¼ê°œë„ë¡ ê°•ì œ ì„¤ì •í–ˆìŠµë‹ˆë‹¤ */
      .character-grid {
        display: grid; 
        grid-template-columns: repeat(6, 1fr); 
        gap: 1.5rem; 
      }

      /* ëª¨ë‹ˆí„°ê°€ ì‘ê±°ë‚˜ ëª¨ë°”ì¼ í™”ë©´ì¼ ë•Œ ì¹´ë“œê°€ ì°Œê·¸ëŸ¬ì§€ì§€ ì•Šê²Œ 3ì¹¸/2ì¹¸ìœ¼ë¡œ ìë™ ì¡°ì •ë˜ëŠ” ë°©ì–´ ì½”ë“œ */
      @media (max-width: 1400px) {
        .character-grid { grid-template-columns: repeat(4, 1fr); }
      }
      @media (max-width: 900px) {
        .character-grid { grid-template-columns: repeat(3, 1fr); }
      }
      @media (max-width: 600px) {
        .character-grid { grid-template-columns: repeat(2, 1fr); gap: 1rem; }
      }

      .empty-slot {
        display: flex; flex-direction: column; gap: 1rem;
        background: #151515; padding: 1.2rem;
        border-radius: 12px; border: 1px dashed #444;
      }
      .empty-slot h3 { margin: 0; color: #555; font-size: 1.3rem; border-bottom: 2px solid #222; padding-bottom: 0.5rem;}
      .empty-box {
        flex: 1; display: flex; justify-content: center; align-items: center;
        background: #0f0f0f; border-radius: 8px; color: #444; font-weight: bold; min-height: 350px; text-align: center;
      }

      /* ğŸš€ ìƒˆ í‘¸í„° ë””ìì¸ (ì™¼ìª½ ì •ë ¬, ê¹”ë”í•œ êµ¬ë¶„) */
      .site-footer { 
        background: #0a0a0a; 
        border-top: 1px solid #222; 
        padding: 3rem 2rem; 
        margin-top: 4rem;
        color: #888;
      }
      .footer-content {
        max-width: 1400px;
        margin: 0 auto;
        display: flex;
        flex-direction: column;
        gap: 0.4rem;
        text-align: left;
      }
      .footer-title {
        color: #eab308;
        font-size: 1.2rem;
        margin: 0 0 0.5rem 0;
      }
      .site-footer p { 
        margin: 0; 
        font-size: 0.85rem; 
        line-height: 1.6;
      }
      .contact-info a {
        color: #aaa;
        text-decoration: underline;
      }
      .contact-info a:hover {
        color: #eab308;
      }
      .copyright {
        margin-top: 1.5rem !important;
      }
      .version-info {
        margin-top: 1rem;
        border-top: 1px solid #222;
        padding-top: 1rem;
      }
    </style>
  </head>
  <body>
    <header class="top-nav">
      <a href="/" class="logo-wrapper">
        <img src="/logo.png" alt="ë¡œê³ " class="logo-img" />
        <span class="logo-text">ê±°ìš¸ë˜ì „ ë©˜í—¤ë¼</span>
      </a>
    </header>

    <div class="container">
      <h1 class="page-title">ê±°ìš¸ë˜ì „ í¸ì„±</h1>
      <p class="page-subtitle">ìˆ˜ì§‘ëœ ì´ ì¸ê²© ë°ì´í„°: {allCharacters.length}ê°œ</p>
      
      <div class="character-grid">
        {groupedCharacters.map(group => (
          group.identities.length > 0 ? (
            <SinnerGroup name={group.name} identities={group.identities} />
          ) : (
            <div class="empty-slot">
              <h3>{group.name}</h3>
              <div class="empty-box">ë°ì´í„°<br>ìˆ˜ì§‘ ì¤‘...</div>
            </div>
          )
        ))}
      </div>
    </div>

    <footer class="site-footer">
      <div class="footer-content">
        <h2 class="footer-title">ê±°ìš¸ë˜ì „ ë©˜í—¤ë¼</h2>
        <p>ë¦¼ë²„ìŠ¤ ì»´í¼ë‹ˆ ë¹„ê³µì‹ ìˆ˜ê°ì ë„ê° ë° í¸ì„± ì‹œë®¬ë ˆì´í„°ì…ë‹ˆë‹¤.</p>
        <p>ë¬¸ì˜ì‚¬í•­ì´ë‚˜ ë²„ê·¸ ì œë³´ëŠ” ì•„ë˜ ì´ë©”ì¼ë¡œ ì—°ë½í•´ì£¼ì„¸ìš”.</p>
        <p class="contact-info">Email: [ì´ë©”ì¼ ì£¼ì†Œ ì…ë ¥ ì˜ˆì •]</p>
        
        <p class="copyright">Â© 2026 ê±°ìš¸ë˜ì „ ë©˜í—¤ë¼</p>
        
        <div class="version-info">
          <p>2026.02.28 Ver.Astro 1.0.0</p>
          <p>ê±°ìš¸ë˜ì „ ë©˜í—¤ë¼ëŠ” í”„ë¡œì íŠ¸ë¬¸ ê³µì‹ ì„œë¹„ìŠ¤ê°€ ì•„ë‹ˆë©°, ì‚¬ìš©ëœ ëª¨ë“  ê²Œì„ ì•„íŠ¸ì›Œí¬, ì •ë³´, ì• ì…‹ì˜ ê¶Œë¦¬ì™€ ì €ì‘ê¶Œì€ í•´ë‹¹ ì €ì‘ê¶Œì(<b>Project Moon</b>)ì˜ ì†Œìœ ì…ë‹ˆë‹¤.</p>
        </div>
      </div>
    </footer>
  </body>
</html>